# Silver Hawk Trading - Project Guide

## Overview

Trading notification system built around a Telegram bot and a multi-agent analysis framework. All notifications, price alerts, and analysis results are delivered via Telegram.

## Monatsziel Februar 2026

**Start:** 950 EUR → **Ziel:** 1.900 EUR (x2)

### Aktueller Stand (04.02.2026)

| Position | Status | P&L |
|----------|--------|-----|
| Apple Turbo (HT7817) | OFFEN - 213 Shares, KO $233.78 | +213 EUR (+37.79%) |
| D-Wave Turbo (HT7AEA) | GESCHLOSSEN - Stop bei 0.19 EUR | -97 EUR (-32.4%) |
| Silber (SI=F) | GESCHLOSSEN - Verkauf +13% | +13 EUR |
| **Netto P&L** | | **+129 EUR** |
| **Verfügbar für neue Trades** | | **~200 EUR** |
| **Portfolio gesamt** | | **~1.000 EUR** |

### Fortschritt zum Ziel
- Noch nötig: ~900 EUR Gewinn (von ~1.000 auf 1.900)
- Verbleibend: ~24 Tage

## Telegram Bot

- **Bot:** @silver_hawk_trading_bot
- **Name:** Silver Hawk Trading
- Credentials stored in `.env` (see below)

### Scripts

**`send_telegram.py`** - Helper module for sending Telegram messages and photos.
- `send_message(text, parse_mode='HTML')` - Send text message
- `send_photo(photo_path, caption='')` - Send photo with optional caption (multipart upload)
- CLI usage: `python send_telegram.py "Your message here"`

**`price_tracker.py`** - Smart price tracker for LOCAL use. Infinite loop, checks every 5 minutes.
- Run: `PYTHONUNBUFFERED=1 nohup python3 -u price_tracker.py 300 > /tmp/silver_hawk_tracker.log 2>&1 &`
- Check log: `tail -f /tmp/silver_hawk_tracker.log`

**`tracker_check.py`** - Single-check version for GitHub Actions (cloud deployment).
- Same alert logic as `price_tracker.py` but runs once and exits
- State (prev_prices, alerted_levels) persisted in Supabase `tracker_state` table
- Uses yfinance directly (no venv subprocess needed)

### Tracked Symbols & Alert Rules
- SI=F (Silber), AAPL (Apple), QBTS (D-Wave), WDC (Western Digital)
- Flash move: >1.5% change in 5 minutes
- Big daily move: >5% intraday change
- Price level crossings (per-symbol thresholds in `ALERT_RULES`)
- Silent hourly summaries, loud alerts for dramatic moves

### GitHub Actions Deployment
- Workflow: `.github/workflows/tracker.yml`
- Schedule: every 10 min during market hours (08:00-22:00 CET), every 30 min overnight
- Weekdays only
- Secrets needed in GitHub repo settings: `TELEGRAM_BOT_TOKEN`, `TELEGRAM_CHAT_ID`, `SUPABASE_URL`, `SUPABASE_ANON_KEY`

## Multi-Agent Analysis

Run with: `Analysiere <SYMBOL> @prompts/00_master.md`

4-step pipeline in `prompts/`:

| Step | File | Agent Role |
|------|------|-----------|
| 1 | `01_data_collection.md` | Fetch yfinance data, generate chart, search news, macro data |
| 2 | `02_investment_debate.md` | Bull vs Bear debate (2 rounds) |
| 3 | `03_judge_risk.md` | Judge decision (LONG/SHORT/NEUTRAL + confidence %), risk analyst debate with 3 analysts, KO levels |
| 4 | `04_summary_send.md` | Trading card, full analysis text, JSON, chart upload to Supabase, DB insert, Telegram delivery |

Additional prompts:
- `05_vs_analysis.md` - Comparative analysis between two assets
- `multi_agent_analysis.md` - Reference/overview document

### Chart Generation

Charts are generated by an external script and uploaded to Supabase storage:
- Script path in `.env` as `CHART_SCRIPT`
- Output dir in `.env` as `CHART_OUTPUT_DIR`
- Uploaded to Supabase storage bucket `charts/`

### Supabase

- Analysis results are stored in the `reminders` table
- Schema: `id, title, description, image_url, due_at, is_done`
- Connection details in `.env` (`SUPABASE_URL`, `SUPABASE_ANON_KEY`)

## Environment

All secrets and paths are in `.env` (not committed to git):

```
TELEGRAM_BOT_TOKEN=...
TELEGRAM_CHAT_ID=...
TELEGRAM_BOT_USERNAME=...
SUPABASE_URL=...
SUPABASE_ANON_KEY=...
YFINANCE_VENV=...          # Path to python3 in trading-crew venv
CHART_SCRIPT=...            # Path to chart generation script
CHART_OUTPUT_DIR=...        # Path to chart output directory
```

**`supabase_client.py`** - Shared Supabase client module. Loads `.env` and provides `supabase_request()`.
- Imported by `admin_stocks.py`, `update_stocks.py`, `browse_stocks.py`
- `send_telegram.py` and `price_tracker.py` have their own `_load_env()` (no external dependencies needed)

## Stock Watchlist

Curated watchlist in Supabase `stocks` table, updated automatically via GitHub Actions.

### Scripts

**`admin_stocks.py`** - Admin CLI for managing the watchlist.
- `python admin_stocks.py list` - Show all stocks
- `python admin_stocks.py add NVDA "NVIDIA" Technology` - Add a stock
- `python admin_stocks.py remove NVDA` - Deactivate (soft delete)
- `python admin_stocks.py seed` - Seed initial watchlist

**`update_stocks.py`** - Fetches yfinance data and updates Supabase. Runs via GitHub Actions every 30 min during market hours.
- Updates: price, change_pct, RSI, SMA50, SMA200, market_cap, volume, analyst_rating
- Workflow: `.github/workflows/update_stocks.yml`

**`browse_stocks.py`** - Read-only watchlist browser.
- `python browse_stocks.py` - Formatted table grouped by sector
- `python browse_stocks.py --json` - JSON output

### Onboarding

Friends fork the repo and set up their own independent instance: own Telegram bot, own Supabase (free tier), own GitHub Actions. See `.env.template` + `ONBOARDING.md`.

## Flutter App (Legacy)

The repo also contains a Flutter reminder app with Supabase integration. This was the original approach before switching to the Telegram bot for all notifications. The Flutter code remains but is no longer the primary interface.
